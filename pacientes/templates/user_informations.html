{% extends "base.html" %}

{% load static %}

{% block 'body' %}

<div class="min-h-screen flex items-center justify-center px-4 py-10 bg-center bg-no-repeat bg-cover" style="background-image: url('{% static "images/Background_app_psicologia.jpg" %}'); background-color: rgba(255, 255, 255, 0.5); background-size: 110% 110%; background-blend-mode: overlay;">

  <div class="py-14 sm:py-14 px-4 grid grid-cols-5 gap-4 w-full">

    <div class="col-span-5 px-6">
      <a class="block text-pretty text-4xl font-semibold tracking-tight text-purple-900 sm:text-3xl mb-1">
        NOME: {{ user.user_psicologo_nome | upper }}<br><br>
        USERNAME: {{ user.user_psicologo_nickname | upper }}
      </a>

      <div class="mt-9 mb-5 flex flex-col gap-1 w-full">
        <hr class="border-t-2 border-purple-800">
        <hr class="border-t-2 border-purple-400">
      </div>
    </div>

    <div class="md:col-start-3 w-full items-center max-w-3xl mx-auto">
      <div class="">
        <div>
          <h2 class="mt-4 text-pretty text-3xl font-semibold uppercase tracking-tight text-purple-900 sm:text-4xl">Minhas informações</h2>

          {% if messages %}
            {% for message in messages %}
              <div class="mt-5 rounded-md {{message.tags}}">
                <div class="flex">
                  <div class="ml-3 py-2">{{message}}</div>
                </div>
              </div>
            {% endfor %}
          {% endif %}

        <form action="{% url 'user_informations' request.session.user_id %}" method="POST" enctype="multipart/form-data"> 
          {% csrf_token %}

            <div>
                <label for="user_psicologo_nome" class="block mt-6 uppercase text-sm/6 font-medium text-purple-600">NOME</label>
                <div class="mt-3">
                {% if user.user_psicologo_nome %}
                    <input type="text" name="user_psicologo_nome" id="user_psicologo_nome" value="{{ user.user_psicologo_nome }}" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                {% else %}
                    <input type="text" name="user_psicologo_nome" id="user_psicologo_nome" placeholder="Insira seu nome completo" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                {% endif %}
                </div>
            </div>

            <div>
                <label for="user_psicologo_email" class="block mt-4 uppercase text-sm/6 font-medium text-purple-600">E-MAIL</label>
                <div class="mt-3">
                {% if user.user_psicologo_email %}
                    <input type="text" name="user_psicologo_email" id="user_psicologo_email" value="{{ user.user_psicologo_email }}" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                {% else %}
                    <input type="text" name="user_psicologo_email" id="user_psicologo_email" placeholder="Insira seu e-mail." class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                {% endif %}
                </div>
            </div>

            <div>
                <label for="user_psicologo_telefone" class="block mt-4 text-sm/6 uppercase font-medium text-purple-600">TELEFONE</label>
                <div class="mt-3">
                {% if user.user_psicologo_telefone %}
                    <input type="text" name="user_psicologo_telefone" id="user_psicologo_telefone" value="{{ user.user_psicologo_telefone }}" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                {% else %}
                    <input type="text" name="user_psicologo_telefone" id="user_psicologo_telefone" placeholder="Insira seu número de telefone" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                {% endif %}
                </div>
            </div>

            <div>
                <label class="block mt-4 text-sm/6 uppercase font-medium text-purple-600">DATA DE NASCIMENTO</label>
                <div class="mt-2 flex gap-3">
                    <select name="user_psicologo_dia" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                        <option disabled {% if not user.user_psicologo_dia %}selected{% endif %}>Dia</option>
                        {% for user_psicologo_dia in user_dias %}
                        <option value="{{user_psicologo_dia.0}}" {% if user.user_psicologo_dia == user_psicologo_dia.0 %}selected{% endif %}>
                            {{user_psicologo_dia.1}}
                        </option>
                        {% endfor %}
                    </select>

                    <select name="user_psicologo_mes" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                        <option disabled {% if not user.user_psicologo_mes %}selected{% endif %}>Mês</option>
                        {% for user_psicologo_mes in user_meses %}
                        <option value="{{user_psicologo_mes.0}}" {% if user.user_psicologo_mes == user_psicologo_mes.0 %}selected{% endif %}>
                            {{user_psicologo_mes.1}}
                        </option>
                        {% endfor %}
                    </select>

                    <select name="user_psicologo_ano" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                        <option disabled {% if not user.user_psicologo_ano %}selected{% endif %}>Ano</option>
                        {% for user_psicologo_ano in user_anos %}
                        <option value="{{user_psicologo_ano.0}}" {% if user.user_psicologo_ano == user_psicologo_ano.0 %}selected{% endif %}>
                            {{user_psicologo_ano.1}}
                        </option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div>
                <label for="user_psicologo_pais" class="block mt-4 uppercase text-sm/6 font-medium text-purple-600">PAÍS DE ORIGEM</label>
                <div class="mt-3">
                    <select name="user_psicologo_pais" class="block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-purple-300 placeholder:text-purple-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6">
                        <option disabled {% if not user.user_psicologo_pais %}selected{% endif %}>País</option>
                        {% for user_psicologo_pais in user_paises %}
                        <option value="{{user_psicologo_pais.0}}" {% if user.user_psicologo_pais == user_psicologo_pais.0 %}selected{% endif %}>
                            {{user_psicologo_pais.1}}
                        </option>
                        {% endfor %}
                    </select>
            </div>
          </div>

          <button type="submit" class="inline-flex justify-center uppercase rounded-md bg-purple-900 mt-7 cursor-pointer px-3 py-2 w-full text-sm font-semibold text-purple-100 shadow-sm hover:bg-purple-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-purple-600">
            ATUALIZAR INFORMAÇÕES
          </button>
        </form>

        </div>

      </div>

    </div>
  </div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const phoneInput = document.getElementById("user_psicologo_telefone");

    phoneInput.addEventListener("input", function (e) {
        let value = e.target.value.replace(/\D/g, "");

        if (value.length > 12) value = value.slice(0, 12);

        let formatted = "";

        if (value.length <= 3) {
            formatted = "(" + value;
        } else if (value.length <= 12) {
            formatted = "(" + value.slice(0, 3) + ") " + value.slice(3);
        }

        e.target.value = formatted;
    });
});
</script>

{% endblock 'body' %}

{% block 'footer' %}
<footer class="bg-purple-900 text-purple-50 text-center py-4">
  © 2025 App Psicologia - Todos os direitos reservados.
</footer>
{% endblock 'footer' %}